{"uid":"502cb9f18a74561d","name":"test_pipeline_services_with_valid_api_key_User","fullName":"tests.test_services.test_user_services_sanity.TestUserServicesWithValidAPIKey#test_pipeline_services_with_valid_api_key_User","historyId":"5057a0ae91d49c0a4770dbcc0c6a2369","time":{"start":1771928895393,"stop":1771928896186,"duration":793},"description":"\n        User : Test Pipeline service with valid API key (ASR → Translation → TTS)\n        ","descriptionHtml":"<pre><code>    User : Test Pipeline service with valid API key (ASR → Translation → TTS)\n</code></pre>\n","status":"broken","statusMessage":"NameError: name 'asr_text' is not defined","statusTrace":"self = <test_user_services_sanity.TestUserServicesWithValidAPIKey object at 0x7779e4b61390>\nuser_client_with_valid_api_key = <utils.api_client.APIClient object at 0x7779e4b63220>\n\n    def test_pipeline_services_with_valid_api_key_User(self, user_client_with_valid_api_key):\n        \"\"\"\n        User : Test Pipeline service with valid API key (ASR → Translation → TTS)\n        \"\"\"\n        endpoint = \"/api/v1/pipeline/inference\"\n        payload = ServiceWithPayloads.pipeline_from_sample()\n    \n        response = user_client_with_valid_api_key.post(endpoint, json=payload)\n    \n        # assert response.status_code == 200, (\n        #     f\"Expected 200, got {response.status_code}. Response: {response.text}\"\n        # )\n    \n        data = response.json()\n        print(data)\n        # assert \"pipelineResponse\" in data\n        # assert len(data[\"pipelineResponse\"]) == 3, \"Expected 3 pipeline tasks\"\n    \n        # # Validate ASR task\n        # asr_task = data[\"pipelineResponse\"][0]\n        # assert asr_task[\"taskType\"] == \"asr\"\n        # assert \"output\" in asr_task\n        # assert len(asr_task[\"output\"]) > 0\n        # assert \"source\" in asr_task[\"output\"][0]\n        # asr_text = asr_task[\"output\"][0][\"source\"]\n    \n        # # Validate Translation task\n        # translation_task = data[\"pipelineResponse\"][1]\n        # assert translation_task[\"taskType\"] == \"translation\"\n        # assert \"output\" in translation_task\n        # assert len(translation_task[\"output\"]) > 0\n        # assert \"source\" in translation_task[\"output\"][0]\n        # assert \"target\" in translation_task[\"output\"][0]\n        # translated_text = translation_task[\"output\"][0][\"target\"]\n    \n        # # Validate TTS task\n        # tts_task = data[\"pipelineResponse\"][2]\n        # assert tts_task[\"taskType\"] == \"tts\"\n        # assert \"audio\" in tts_task or \"output\" in tts_task\n    \n        # # Check for audio content in either location\n        # if \"audio\" in tts_task and tts_task[\"audio\"]:\n        #     assert \"audioContent\" in tts_task[\"audio\"][0]\n        #     audio_content = tts_task[\"audio\"][0][\"audioContent\"]\n        # elif \"output\" in tts_task and tts_task[\"output\"]:\n        #     assert \"audioContent\" in tts_task[\"output\"][0]\n        #     audio_content = tts_task[\"output\"][0][\"audioContent\"]\n        # else:\n        #     raise AssertionError(\"No audio content found in TTS task\")\n    \n        print(f\"\\n✅ USER Pipeline (ASR → Translation → TTS):\")\n>       print(f\"   ASR: '{asr_text}'\")\nE       NameError: name 'asr_text' is not defined\n\ntests/test_services/test_user_services_sanity.py:327: NameError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"user_token_manager","time":{"start":1771928883593,"stop":1771928887093,"duration":3500},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop_policy","time":{"start":1771928883593,"stop":1771928883593,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"user_client_with_valid_api_key","time":{"start":1771928887093,"stop":1771928887093,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"\n        User : Test Pipeline service with valid API key (ASR → Translation → TTS)\n        ","status":"broken","statusMessage":"NameError: name 'asr_text' is not defined","statusTrace":"self = <test_user_services_sanity.TestUserServicesWithValidAPIKey object at 0x7779e4b61390>\nuser_client_with_valid_api_key = <utils.api_client.APIClient object at 0x7779e4b63220>\n\n    def test_pipeline_services_with_valid_api_key_User(self, user_client_with_valid_api_key):\n        \"\"\"\n        User : Test Pipeline service with valid API key (ASR → Translation → TTS)\n        \"\"\"\n        endpoint = \"/api/v1/pipeline/inference\"\n        payload = ServiceWithPayloads.pipeline_from_sample()\n    \n        response = user_client_with_valid_api_key.post(endpoint, json=payload)\n    \n        # assert response.status_code == 200, (\n        #     f\"Expected 200, got {response.status_code}. Response: {response.text}\"\n        # )\n    \n        data = response.json()\n        print(data)\n        # assert \"pipelineResponse\" in data\n        # assert len(data[\"pipelineResponse\"]) == 3, \"Expected 3 pipeline tasks\"\n    \n        # # Validate ASR task\n        # asr_task = data[\"pipelineResponse\"][0]\n        # assert asr_task[\"taskType\"] == \"asr\"\n        # assert \"output\" in asr_task\n        # assert len(asr_task[\"output\"]) > 0\n        # assert \"source\" in asr_task[\"output\"][0]\n        # asr_text = asr_task[\"output\"][0][\"source\"]\n    \n        # # Validate Translation task\n        # translation_task = data[\"pipelineResponse\"][1]\n        # assert translation_task[\"taskType\"] == \"translation\"\n        # assert \"output\" in translation_task\n        # assert len(translation_task[\"output\"]) > 0\n        # assert \"source\" in translation_task[\"output\"][0]\n        # assert \"target\" in translation_task[\"output\"][0]\n        # translated_text = translation_task[\"output\"][0][\"target\"]\n    \n        # # Validate TTS task\n        # tts_task = data[\"pipelineResponse\"][2]\n        # assert tts_task[\"taskType\"] == \"tts\"\n        # assert \"audio\" in tts_task or \"output\" in tts_task\n    \n        # # Check for audio content in either location\n        # if \"audio\" in tts_task and tts_task[\"audio\"]:\n        #     assert \"audioContent\" in tts_task[\"audio\"][0]\n        #     audio_content = tts_task[\"audio\"][0][\"audioContent\"]\n        # elif \"output\" in tts_task and tts_task[\"output\"]:\n        #     assert \"audioContent\" in tts_task[\"output\"][0]\n        #     audio_content = tts_task[\"output\"][0][\"audioContent\"]\n        # else:\n        #     raise AssertionError(\"No audio content found in TTS task\")\n    \n        print(f\"\\n✅ USER Pipeline (ASR → Translation → TTS):\")\n>       print(f\"   ASR: '{asr_text}'\")\nE       NameError: name 'asr_text' is not defined\n\ntests/test_services/test_user_services_sanity.py:327: NameError","steps":[],"attachments":[{"uid":"3f15401ed3913238","name":"Request — POST","source":"3f15401ed3913238.json","type":"application/json","size":188371},{"uid":"f07fbd377d801f23","name":"Response — 401","source":"f07fbd377d801f23.json","type":"application/json","size":103},{"uid":"222a623eb7c6b99f","name":"stdout","source":"222a623eb7c6b99f.txt","type":"text/plain","size":125}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":3,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"user_token_manager::0","time":{"start":1771928917907,"stop":1771928917908,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"parentSuite","value":"tests.test_services"},{"name":"suite","value":"test_user_services_sanity"},{"name":"subSuite","value":"TestUserServicesWithValidAPIKey"},{"name":"host","value":"TI-LAP-1094"},{"name":"thread","value":"1726549-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_services.test_user_services_sanity"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":0,"broken":2,"skipped":0,"passed":0,"unknown":0,"total":2},"items":[{"uid":"aefb0b7edc2809db","status":"broken","statusDetails":"NameError: name 'asr_text' is not defined","time":{"start":1771914031944,"stop":1771914032288,"duration":344}}]},"tags":[]},"source":"502cb9f18a74561d.json","parameterValues":[]}